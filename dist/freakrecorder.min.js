!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var s in n)("object"==typeof exports?exports:e)[s]=n[s]}}(this,(()=>(()=>{"use strict";var e={341:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});let n=0,s=!1;const i=new MutationObserver((e=>{Date.now()-n<=1e3&&e.length>0&&(console.log("Mutations",e),s=!0,i.disconnect())}));i.observe(document.body,{childList:!0,attributes:!0,subtree:!0}),t.default=class{constructor(e,t){this.config=e,this.sendBatchEvents=t,this.lastEvent=null,this.eventQueue=[],this.batchSize=10,this.batchTime=1e4,this.debounceTimer=null,this.defaultInteractableTags=["BUTTON","A","INPUT","SELECT","TEXTAREA","DIV"]}startBatchTimer(){this.batchTimer=setInterval((()=>{this.eventQueue.length>0&&this.flushEventQueue()}),this.batchTime)}flushEventQueue(){this.eventQueue.length>0&&(this.sendBatchEvents([...this.eventQueue]),this.eventQueue=[])}init(){["click","input","scroll"].forEach((e=>{document.body.addEventListener(e,this.handleEvent.bind(this),!0)})),document.body.addEventListener("focus",(e=>{console.log("focus",e)})),window.addEventListener("load",this.handlePageLoad.bind(this),!0),window.addEventListener("beforeunload",this.handelBeforeUnload.bind(this),!0),this.startBatchTimer()}handelBeforeUnload(){this.lastEvent&&this.eventQueue.push(this.lastEvent)}handlePageLoad(){const e={eventType:"pageLoad",timestamp:(new Date).toISOString(),pageUrl:window.location.href,tagName:null,attributes:{},textContent:""};this.eventQueue.push(e)}sendEvent(e){this.eventQueue.push(e),this.eventQueue.length>=this.batchSize&&this.flushEventQueue()}handleEvent(e){let t=e.target;if(t=this.findInteractableParent(t),t){n=Date.now(),s=!1;const a=this.extractEventData(e,t);i.observe(document.body,{childList:!0,attributes:!0,subtree:!0}),this.lastEvent&&this.lastEvent.eventType!==a.eventType&&(this.sendEvent(this.lastEvent),this.lastEvent=null),setTimeout((()=>{this.isInteractable(t)&&("DIV"===t.tagName&&s?this.eventQueue.push(a):"input"===e.type&&"INPUT"===t.tagName?this.lastEvent=this.extractEventData(e,t):["DIV"].includes(t.tagName)||"input"==e.type||this.sendEvent(a)),i.disconnect()}),1e3),clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{this.lastEvent&&(this.sendEvent(this.lastEvent),this.lastEvent=null)}),7e3)}}extractEventData(e,t){var n;let s=this.getElementAttributes(t);return Object.keys(s).forEach((e=>{const t=s[e];this.isEmail(t)?s[e]="redacted-email":this.isPhoneNumber(t)?s[e]="redacted-phone":this.isCreditCardNumber(t)&&(s[e]="redacted-cc")})),{eventType:e.type,timestamp:(new Date).toUTCString(),tagName:t.tagName,attributes:s,textContent:null===(n=t.textContent)||void 0===n?void 0:n.trim(),pageUrl:window.location.href,sessionId:this.config.sessionId,userId:this.config.userId}}isEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isPhoneNumber(e){return/(?:\+?(\d{1,3}))?[-.\s]?(?:\((\d{1,4})\)|(\d{1,4}))?[-.\s]?(\d{1,4})[-.\s]?(\d{1,4})[-.\s]?(\d{1,9})/.test(e.replace(/\D/g,""))}isCreditCardNumber(e){return/\b\d{13,16}\b/.test(e.replace(/\D/g,""))}findInteractableParent(e){for(;e&&e!==document.body&&e!==document.documentElement;){if(this.isInteractable(e))return e;e=e.parentElement}return null}isInteractable(e){return!!this.defaultInteractableTags.concat(this.config.additionalInteractableTags||[]).includes(e.tagName)||!(!this.config.interactableAttribute||!e.hasAttribute(this.config.interactableAttribute))}getElementAttributes(e){const t=["data-email","data-cc-number"];return Array.from(e.attributes).reduce(((e,n)=>(t.includes(n.name)||(e[n.name]=n.value),e)),{})}}}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,n),a.exports}var s={};return(()=>{var e=s;Object.defineProperty(e,"__esModule",{value:!0});const t=n(341);function i(){let e=sessionStorage.getItem("sessionId");return e||(e="sess-"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("sessionId",e)),e}function a(){let e=localStorage.getItem("userId");return e||(e="user-"+Math.random().toString(36).substr(2,9),localStorage.setItem("userId",e)),e}window.nullRecorder=function(e){e=Object.assign(Object.assign({},e),{sessionId:i(),userId:a()}),new t.default(e,(t=>{e.apiKey?fetch("https://ohzzb0pmv7.execute-api.eu-west-2.amazonaws.com/prod/events",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e.apiKey},body:JSON.stringify(t)}).then((e=>{if(e.ok)return e.json()})).then((e=>{})).catch((e=>{})):console.error("Missing apiKey")})).init()}})(),s})()));